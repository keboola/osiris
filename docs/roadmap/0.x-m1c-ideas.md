# Milestone M1c: Compile and Run MVP

## Overview
This milestone delivers a minimal viable product (MVP) for the compilation and execution track of Osiris pipelines. It focuses on deterministic, secret-free compilation of OML into runnable artifacts, local sequential execution, and basic manifest utilities.

## Scope

### OML Compilation
- Validate input OML against schema.
- Resolve parameters with precedence (CLI, ENV, profiles).
- Expand DAG with deterministic topological sorting.
- Generate canonicalized manifests and per-step configs.
- Emit provenance metadata and effective configuration.
- Enforce no secrets in OML or artifacts.
- No LLM required — compiler must be deterministic and rule-based.
  - Must follow ADR-0014 (OML v0.1.0 schema & scope) and ADR-0015 (Compile Contract — determinism, fingerprints, no-secrets).

### Runner MVP
- Local, sequential execution of steps.
- Support retry, timeout, and idempotency.
- Basic artifact and metrics tracking.
- Minimal resource constraints and privacy labels.

### Manifest Utilities (Skeleton)
- `osiris manifest verify`
- `osiris manifest diff`
- `osiris manifest lock`
- `osiris manifest unlock`

## Deliverables
- `osiris compile` CLI command with `--compile=auto|force|never`.
- Generated artifacts: `manifest.yaml`, `cfg/*.json`, `meta.json`, `effective_config.json`.
- Basic local runner executing compiled pipelines.
- Manifest utilities with minimal verification features.
- Documentation updates covering compilation and run contract.
- Must align with ADR-0014 and ADR-0015 for schema, determinism, and artifact contracts.

## Acceptance Criteria
- Compilation produces byte-identical artifacts for identical inputs.
- Secrets in OML cause compilation failure with clear errors.
- Runner executes pipeline steps in correct order respecting DAG.
- Manifest utilities perform basic verification and diff operations.
- CLI commands exit with correct status codes on success and error.
- Implementation demonstrably follows ADR-0014 and ADR-0015 (schema validation, deterministic compilation, secret-free artifacts).

## Connection Resolution (M1c Addition)
As documented in ADR-0020, M1c now includes minimal connection resolution functionality:
- `osiris_connections.yaml` format for non-secret connection metadata
- Environment variable substitution for secrets (`${ENV_VAR}`)
- Default connection selection precedence
- CLI commands: `connections list` and `connections doctor`

The interactive connection wizard (`connections add`) and chat-based multi-connection UX features are deferred to M1d for focused MVP delivery.

## Next Steps (M1d Preview)
M1d will build upon the MVP foundation with:
- Interactive connection wizard (`connections add`)
- Chat-based multi-connection UX
- DuckDB transforms for data processing
- **Streaming IO and Spill (ADR-0022)**: Iterator-first RowStream interface for memory-safe processing of 10GB+ datasets
- **Remote Object Store Writers (ADR-0023)**: Direct writing to S3, Azure Blob, and GCS with multipart upload support
